<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>TradingBot Pro - Dashboard</title>
    <!-- CSS files -->
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta17/dist/css/tabler.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/icons-sprite.svg" rel="stylesheet"/>
    <link href="css/custom.css" rel="stylesheet"/>
    <style>
      @import url('https://rsms.me/inter/inter.css');
      :root {
        --tblr-font-sans-serif: 'Inter Var', -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif;
      }
      body {
        font-feature-settings: "cv03", "cv04", "cv11";
      }
      
      .system-status-banner {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        color: white;
        padding: 1rem;
        border-radius: 8px;
        display: flex;
        align-items: center;
        gap: 1rem;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }
      
      .system-status-banner.status-success {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      }
      
      .system-status-banner.status-warning {
        background: linear-gradient(135deg, #fd7e14 0%, #ffc107 100%);
      }
      
      .system-status-banner.status-loading {
        background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
      }
      
      .status-indicator {
        font-size: 1.5rem;
        animation: pulse 2s infinite;
      }
      
      .status-content {
        flex: 1;
      }
      
      .status-title {
        font-weight: bold;
        font-size: 1.1rem;
      }
      
      .status-subtitle {
        opacity: 0.8;
        font-size: 0.9rem;
      }
      
      @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
      }
      
      .status-dot {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 8px;
      }
      
      .status-dot-animated {
        animation: pulse 2s infinite;
      }
      
      #toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
      }
    </style>
</head>

<body class="theme-dark">
    <script src="js/demo-theme.min.js?1684106062"></script>
    <div class="page">
        <!-- Sidebar -->
        <aside class="navbar navbar-vertical navbar-expand-lg" data-bs-theme="dark">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu" aria-controls="sidebar-menu" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <h1 class="navbar-brand navbar-brand-autodark">
                    <a href="index.html">
                        <img src="assets/logo.svg" width="110" height="32" alt="TradingBot Pro" class="navbar-brand-image">
                    </a>
                </h1>
                
                <div class="collapse navbar-collapse" id="sidebar-menu">
                    <ul class="navbar-nav pt-lg-3">
                        <li class="nav-item">
                            <a class="nav-link active" href="index.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l-2 0l9 -9l9 9l-2 0" /><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" /><path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" /></svg>
                                </span>
                                <span class="nav-link-title">Dashboard</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="pipeline.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" /><path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" /></svg>
                                </span>
                                <span class="nav-link-title">AI Pipeline</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="backtesting.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z" /><path d="M16 3v4" /><path d="M8 3v4" /><path d="M4 11h16" /><path d="M11 15h1" /><path d="M12 15v3" /></svg>
                                </span>
                                <span class="nav-link-title">Backtesting</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="performance.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" /><path d="M12 7v5l3 3" /></svg>
                                </span>
                                <span class="nav-link-title">Performance</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="settings.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" /><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" /></svg>
                                </span>
                                <span class="nav-link-title">Settings</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </aside>
        
        <!-- Page header -->
        <div class="page-wrapper">
            <div class="page-header d-print-none">
                <div class="container-xl">
                    <div class="row g-2 align-items-center">
                        <div class="col">
                            <h2 class="page-title">Dashboard</h2>
                            <div class="text-muted mt-1">System Overview & Quick Actions</div>
                        </div>
                        <div class="col-auto ms-auto d-print-none">
                            <div class="btn-list">
                                <span class="text-muted me-3">
                                    Environment: <span class="badge bg-warning" id="environment-badge">Loading...</span>
                                </span>
                                <span class="text-muted me-3">
                                    Risk Tier: <span class="badge bg-secondary" id="risk-tier-badge">Loading...</span>
                                </span>
                                <span class="d-none d-sm-inline">
                                    <a href="#" class="btn" id="emergency-stop">
                                        🛑 Emergency Stop
                                    </a>
                                </span>
                                <a href="#" class="btn btn-primary d-none d-sm-inline-block" id="refresh-data">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4" /><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" /></svg>
                                    Refresh Data
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Page body -->
            <div class="page-body">
                <div class="container-xl">
                    <!-- System Status Banner -->
                    <div class="system-status-banner mb-4 status-loading" id="system-status-banner">
                        <div class="status-indicator">�</div>
                        <div class="status-content">
                            <div class="status-title">LOADING SYSTEM STATUS...</div>
                            <div class="status-subtitle">Connecting to Bybit API and initializing dynamic risk management</div>
                        </div>
                    </div>
                    
                    <!-- Risk Warnings Container -->
                    <div id="risk-warnings" class="mb-4">
                        <!-- Dynamic risk warnings will be populated here -->
                    </div>

                    <!-- Quick Stats Row -->
                    <div class="row row-deck row-cards mb-4">
                        <div class="col-sm-6 col-lg-3">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="subheader">Portfolio Value</div>
                                        <div class="ms-auto lh-1">
                                            <div class="dropdown">
                                                <a class="dropdown-toggle text-muted" href="#" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Last 7 days</a>
                                                <div class="dropdown-menu dropdown-menu-end">
                                                    <a class="dropdown-item active" href="#">Last 7 days</a>
                                                    <a class="dropdown-item" href="#">Last 30 days</a>
                                                    <a class="dropdown-item" href="#">Last 3 months</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="h1 mb-3" id="portfolio-value">$25,380</div>
                                    <div class="d-flex mb-2">
                                        <div class="flex-fill">
                                            <div class="progress progress-sm">
                                                <div class="progress-bar bg-primary" style="width: 76%" role="progressbar" aria-valuenow="76" aria-valuemin="0" aria-valuemax="100" aria-label="76% Complete">
                                                    <span class="visually-hidden">76% Complete</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-success ms-3" id="portfolio-change">+2.3%</div>
                                    </div>
                                    <div class="text-muted">Last updated: <span id="last-update">Just now</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-3">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="subheader">Active Strategies</div>
                                    </div>
                                    <div class="h1 mb-3" id="active-strategies">3</div>
                                    <div class="d-flex mb-2">
                                        <div>
                                            <span class="badge bg-green me-1">2</span> Paper Trading
                                        </div>
                                        <div class="ms-auto">
                                            <span class="badge bg-blue">1</span> Live Trading
                                        </div>
                                    </div>
                                    <div class="text-muted">Max positions: <span id="max-positions">Loading...</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-3">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="subheader">Today's P&L</div>
                                    </div>
                                    <div class="h1 mb-3 text-success" id="today-pnl">+$142</div>
                                    <div class="d-flex mb-2">
                                        <div class="flex-fill">
                                            <div class="progress progress-sm">
                                                <div class="progress-bar bg-success" style="width: 60%" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-success ms-3">+0.6%</div>
                                    </div>
                                    <div class="text-muted">Portfolio utilization: <span id="portfolio-utilization">Loading...</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-3">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="subheader">System Health</div>
                                        <div class="ms-auto">
                                            <span class="status-dot status-dot-animated bg-green"></span>
                                        </div>
                                    </div>
                                    <div class="h1 mb-3" id="system-health">
                                        <span class="status-dot bg-secondary"></span>
                                        Loading...
                                    </div>
                                    <div class="d-flex mb-2">
                                        <div class="text-muted">Balance trend: <span id="balance-trend">Loading...</span></div>
                                    </div>
                                    <div class="text-muted">API: Connected • DB: Healthy</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pipeline Summary -->
                    <div class="row row-deck row-cards mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">AI Pipeline Summary</h3>
                                    <div class="card-actions">
                                        <span class="badge bg-success">Auto-Discovery Active</span>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="row text-center">
                                        <div class="col-md-4">
                                            <div class="pipeline-stage backtesting">
                                                <div class="h1 text-muted mb-2">🧪</div>
                                                <div class="h2" id="backtest-count">12</div>
                                                <div class="text-muted">Backtesting</div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="pipeline-stage paper">
                                                <div class="h1 text-muted mb-2">📝</div>
                                                <div class="h2" id="paper-count">2</div>
                                                <div class="text-muted">Paper Trading</div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="pipeline-stage live">
                                                <div class="h1 text-muted mb-2">🚀</div>
                                                <div class="h2" id="live-count">1</div>
                                                <div class="text-muted">Live Trading</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity & Performance Chart -->
                    <div class="row row-deck row-cards">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">Recent Activity</h3>
                                </div>
                                <div class="card-body">
                                    <div class="divide-y" id="recent-activity">
                                        <div class="row">
                                            <div class="col-auto">
                                                <span class="status-dot status-dot-animated bg-green d-block"></span>
                                            </div>
                                            <div class="col">
                                                <div class="text-truncate">Strategy BTC_M_55632 graduated to live trading</div>
                                                <div class="text-muted">10 minutes ago</div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-auto">
                                                <span class="status-dot bg-blue d-block"></span>
                                            </div>
                                            <div class="col">
                                                <div class="text-truncate">ML discovery completed - 12 new strategies found</div>
                                                <div class="text-muted">25 minutes ago</div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-auto">
                                                <span class="status-dot bg-yellow d-block"></span>
                                            </div>
                                            <div class="col">
                                                <div class="text-truncate">ETH_H_33421 moved to paper trading phase</div>
                                                <div class="text-muted">1 hour ago</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">System Alerts</h3>
                                </div>
                                <div class="card-body">
                                    <div class="divide-y" id="system-alerts">
                                        <div class="row">
                                            <div class="col-auto">
                                                <span class="status-dot bg-green d-block"></span>
                                            </div>
                                            <div class="col">
                                                <div class="text-truncate">All API connections stable</div>
                                                <div class="text-muted">System check - 2 minutes ago</div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-auto">
                                                <span class="status-dot bg-blue d-block"></span>
                                            </div>
                                            <div class="col">
                                                <div class="text-truncate">Database backup completed successfully</div>
                                                <div class="text-muted">30 minutes ago</div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-auto">
                                                <span class="status-dot bg-yellow d-block"></span>
                                            </div>
                                            <div class="col">
                                                <div class="text-truncate">Risk management updated position limits</div>
                                                <div class="text-muted">2 hours ago</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tabler Core -->
    <script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta17/dist/js/tabler.min.js"></script>
    <script src="js/app.js"></script>
    <script src="dashboard.js"></script>
    
    <!-- Toast Container -->
    <div id="toast-container"></div>
</body>
</html>